<%= render "shared/navbar" %>

<div class="container footer-margin" data-controller="modals">
  <h2 class="h2-margin">Over <%= @vehicles.count %> <%= 'vehicle'.pluralize(@vehicles.count) %> nearby. Rent yours now!</h2>
  <div class="d-flex gap-5">
    <div class="col-vehicles">
      <% @vehicles.each do |vehicle| %>
        <div class="card-vehicle">
          <div class="card-image-size">
            <% if vehicle.photo.attached? %>
              <%= cl_image_tag(vehicle.photo.key, alt: "photo-vehicle", crop: :fill, class: "card-image-size") %>
            <% else %>
              <%= cl_image_tag('/eaa35mokrpgg4yg15ngp', alt: "random-photo-vehicle", crop: :fill, class: "card-image-size") %>
            <% end %>
          </div>

          <div class="vehicle-description">
            <h3><%= vehicle.name %></h3>
            <p>
              <strong>Capacity:</strong> <%= vehicle.passengers_capacity %> <%= vehicle.passengers_capacity > 1 ? 'people' : 'person' %><br>
              <strong>Price:</strong> <%= vehicle.price_per_day.to_i %>â‚¬/day<br>
              <strong>Vehicle type:</strong> <%= vehicle.vehicle_type %><br>
              <strong>Ecological label:</strong> <%= vehicle.ecological_label %>
            </p>

            <!-- Modal -->
            <div class="d-flex align-items-center gap-3">
              <div class="btn-airatp-lightblue" data-action="click->modals#openModal" data-id="<%= vehicle.id %>">More details</div>
              <div class="btn-airatp-redpink"><%= link_to "Choose this vehicle", vehicle_path(vehicle), class: "links" %></div>
            </div>
          </div>
        </div>

        <div class="modal" data-modals-target="modal" data-id="<%= vehicle.id %>">
          <div class="modal-content">
            <span class="close" data-action="click->modals#closeModal" data-modals-target="modal" data-id="<%= vehicle.id %>">&times;</span>
            <h3><%= vehicle.name %> <i class="fa-solid fa-star">4.9</i></h3>
            <i class="fa-solid fa-user"> <%= vehicle.passengers_capacity %></i>
            <p class="mt-3"><%= vehicle.description %></p>
          </div>
        </div>
      <% end %>
    </div>

    <div id="map-container"
      data-controller="map"
      data-map-markers-value="<%= @markers.to_json %>"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>
